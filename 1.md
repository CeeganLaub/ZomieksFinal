lan: Fiverr Clone - Full Marketplace with CRM
A freelance marketplace with multi-package services, seller subscriptions, escrow payments via PayFast/OZOW, and a full-featured chat CRM system.

Key Architecture Decisions:

PayFast for cards + recurring subscriptions, OZOW for instant EFT
Self-managed escrow with BullMQ for delayed fund releases
Conversation-centric CRM with pipeline stages, auto-triggers, and analytics
Redis pub/sub for real-time updates across Socket.io instances
Steps
Phase 1: Project Foundation

Initialize monorepo structure with /apps/web (Vite + React), /apps/api (Express), /packages/shared (types, Zod schemas)
Configure TypeScript with strict mode, path aliases, and shared configs
Set up TailwindCSS + Radix UI + CVA component system
Configure Prisma with PostgreSQL connection and initial migration setup
Set up Redis connection for sessions, caching, and pub/sub
Configure BullMQ with dedicated queues: escrow-release, notifications, subscriptions, payouts
Phase 2: Database Schema (50+ models)

Create core user models: User, Profile, UserRole with dual-role support (buyer + seller simultaneously)
Create service models: Service, ServicePackage (Basic/Standard/Premium tiers), SubscriptionTier, Category, Tag
Create order models: Order, OrderMilestone, OrderDelivery, OrderRevision with escrow status tracking
Create subscription models: Subscription, SubscriptionPayment, SubscriptionTier with PayFast integration fields
Create CRM models: Conversation, Message, PipelineStage, Label, ConversationNote, SavedReply, AutoTrigger, Activity
Create payment models: Transaction, EscrowHold, SellerPayout, Dispute, Refund with PayFast/OZOW references
Create analytics models: ConversationMetrics, SellerMetrics for pre-aggregated stats
Phase 3: Authentication & Authorization

Implement JWT auth with 15min access tokens, 7-day refresh tokens
Create RBAC middleware with roles: BUYER, SELLER, ADMIN, MODERATOR, SUPPORT, FINANCE, SUPER_ADMIN
Build seller onboarding flow (profile, payment details, verification)
Implement session management with Redis for logout-all functionality
Phase 4: Service & Package System

Build seller dashboard for creating services with multi-package pricing
Create service PDP (Product Detail Page) with package comparison, reviews, seller info
Implement subscription tier creation for sellers (monthly/quarterly/yearly)
Build category browsing, search, and filtering with Zustand + TanStack Query
Create service cards, galleries, FAQ sections matching Fiverr UX
Phase 5: Payment Integration

Create unified PaymentGateway interface with PayFastGateway and OzowGateway implementations
Implement PayFast ITN webhook handler with signature validation, IP verification, server confirmation
Implement OZOW webhook handler with SHA512 hash verification
Build checkout flow with gateway selection (cards → PayFast, instant EFT → OZOW)
Create PayFast recurring subscription integration for seller subscription services
Build payment history and invoice generation
Phase 6: Escrow System

Implement escrow hold on payment completion (funds in platform account, status HELD)
Create milestone-based release triggers for one-time orders
Create time-delayed release for subscriptions (7-day hold via BullMQ)
Build dispute flow that blocks escrow release until resolved
Create weekly payout batch job for seller bank transfers
Build seller payout dashboard with earnings, pending, and paid views
Phase 7: Chat & Full CRM

Set up Socket.io with namespaces: /chat, /crm, /notifications, /presence
Create real-time messaging with typing indicators, read receipts, file attachments
Build conversation list with filters (status, labels, pipeline stage)
Implement CRM pipeline board (Kanban-style drag-and-drop with @dnd-kit)
Create lead scoring based on conversation activity and order history
Build saved replies with /shortcut quick access
Implement auto-triggers: welcome messages, inactivity follow-ups, stage-change responses
Create conversation notes and activity timeline
Build CRM analytics dashboard: response time, conversion rates, deal pipeline value
Implement Redis pub/sub for multi-server Socket.io scaling
Phase 8: Order Management

Create order placement flow from service packages
Build order inbox with status tracking, timelines, and messaging
Implement delivery submission and approval flow
Create revision request system with limit tracking per package
Build order completion with escrow release trigger
Implement cancellation and refund workflows
Phase 9: PWA & Real-time Features

Configure Vite PWA plugin for offline support and caching
Implement push notifications for messages, orders, and payouts
Build presence system for online/offline status
Create notification center with real-time updates
Phase 10: Admin & Moderation

Build admin dashboard for user management, disputes, and payouts
Create moderation queue for service approval
Implement platform analytics and revenue tracking
Build support ticket integration with CRM
Verification
Unit tests: Zod schemas, payment signature generators, escrow logic
Integration tests: PayFast/OZOW webhook flows, subscription lifecycle, CRM triggers
E2E tests: Full order flow, subscription purchase, chat conversations
Manual testing: Complete buyer and seller journeys with test payment modes
Load testing: Socket.io connections at scale with Redis adapter